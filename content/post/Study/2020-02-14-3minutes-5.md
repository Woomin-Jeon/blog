---
title: 하루 3분 네트워크 교실 스터디 5
date: 2020-02-14
tag: [Study]
---

## "하루 3분 네트워크 교실" 스터디 5

### 5장: 커넥션과 포트 번호

- 흐름제어  
  4계층의 역할로는 `흐름제어`가 있는데, 흐름제어란 데이터가 도달했을 때, 대기장소에 데이터가 넘치는 것(플로)를 방지하는 것이다. 만약 수신처 컴퓨터가 보내는 대기장소의 용량이 얼마 남지 않았다면 송신처에서 보내는 데이터를 가감하거나 잠시 중단하는 등의 하는데 이것이 흐름제어의 과정이다.

- 포트번호  
  4계층에서는 이제 수신된 데이터들을 어플리케이션 차원에서 처리를 해주어야 하기 때문에 수신된 데이터가 어떤 어플리케이션의 것인지 알기 위해서 포트번호가 필요하다.  
  추가적으로 포트번호에는 `Well Known Port`가 존재하는데 이는 0 ~ 1023까지의 포트번호를 의미한다. 자주 사용하는 서버 어플리케이션은 이렇게 웰논 포트를 사용함으로써 서비스를 제공할 수 있도록 한다.

- 커넥션  
  TCP에서 커넥션이란 데이터를 확실하게 주고받기 위한 가상적인 통신로로, 데이터 전송을 시작하기 전에 송신 컴퓨터와 수신컴퓨터가 미리 확인을 주고받아 두는 것을 의미한다. 이 과정에는 `3-way-handshake` 방식이 사용된다. 이는 쉽게 말해서 (1)송신컴퓨터: 나 보낸다?  
  (2)수신컴퓨터: 어! 보내!  
  (3)송신컴퓨터: 알았어! 이제 보낼게!  
  라고 볼 수있다.

- TCP에서의 에러복구  
  TCP에서는 확인 응답에 따라 재전송을 수행하여 에러를 복구한다. 예를들어, 시퀀스 번호 2001을 보냈는데 이후, 수신 컴퓨터에서 다음 시퀀스 번호인 3001을 보내지 않는다면 이를 에러가 발생헀다고 간주해서 시퀀스 번호 2001을 재전송한다.

- 윈도우 사이즈  
  `윈도우 사이즈`란, 윈도우 제어에서 상대방에게 자신이 어느정도의 버퍼량을 가지고 있는지 알려주는 것이다. 이를 통대 송신 컴퓨터는 데이터의 양을 조절해서 수신 컴퓨터의 오버플로우를 발생시키지 않도록 한다.

- UDP  
  TCP는 에러복구를 위해서 확인응답을 기다려야 하며 이에는 시간이 소요된다. 하지만 UDP는 확인응답을 기다리지 않고 그냥 데이터를 보내기만 하므로 확인응답시간이 소요되지 않고 당연히 고속송신이 가능하다.  
  참고로 UDP에서의 브로드캐스트는 확인응답이 없기 때문에 호스트 번호가 모두 1인 브로드캐스트 주소를 사용한다.

- NAT  
  NAT는 우주복으로 비유하면 이해하기 쉽다. 기존에는 우주 밖(네트워크 밖)으로 나가기 위해서는 각자 개인에게 고유하게 주어진 우주복(IP 주소)이 있었다. 하지만 우주복이 점점 부족해지면서 우주복을 받지 못한 사람은 우주 밖으로 나갈 수 없게 될 위험에 처해졌는데 이러한 문제를 해결하기 위해서 우주복을 개인에게 고유하게 주는 것이 아니라 우주선 입구에 공용 우주복을 걸어놓은 것이다. 이제 모든 사람은 그 공용 우주복을 입고 우주에 나갈 수 있게 되는데 이런 역할을 하는 게 NAT이다.
  하지만 NAT에서도 공용 우주복 개수에 제한이 있기 때문에 동시에 우주로 나갈 수 있는 사람은 우주복의 개수로 제한된다.

- NAPT  
  이렇게 동시에 모든 사람이 우주로 나갈 수 없는 NAT의 단점을 해결하기 위해서 NAPT가 등장하였다. NAPT는 IP 주소 뒤에 포트번호를 붙여서 하나의 IP 주소로도 여러 명이 동시에 사용할 수 있도록 하는 것이다.  
  하지만 NAPT를 사용하면 NAPT 테이블에 저장되어 있지 않은 것은 LAN 내부에 들어올 수 없기 때문에 이런 부분을 해결하기 위해 NAPT 테이블에 수동적으로 입력한다. 이를 `정적 NAPT`라고 한다.

- OSI 5, 6, 7계층  
  5계층은 세션 계층으로, 어플리케이션 간에 대화가 성립되도록 제어하는 역할을 한다.  
  6계층은 표현 계층으로, 데이터 형식을 상호 컴퓨터간 호환되도록 변환하는 역할을 한다.
  7계층은 응용 계층으로, 어플리케이션의 목적에 따라 네트워크 서비스를 제공하는 역할을 한다.