---
title: 2021-11-06 WIL
date: 2021-11-06
category: "All"
draft: true
---

## Facts

- 이번주에는 새롭고 큼직한 피쳐를 치게되었습니다. 일단 API 만들어지기 전에 디자인 시안으로 MOCK 데이터 만들어서 UI만 구성하고 API 완성된 이후 적용을 하는 방식으로 구현을 했습니다.
- 새로운 피쳐를 치면서 어떻게하면 좋은 코드를 작성할까 고민을 많이했습니다. 새로운 걸 만드는 즐거움도 있었지만 시간을 들이고 좋은 코드를 위해 고민하는 시간을 갖는 게 너무 좋았습니다. 근데 좋아졌는지는 잘 모르겠... ㅠ 그래도 근거가 있는 코드를 짠 것에 만족합니다. 다음주엔 조금 더 들여다보면서 더더 좋게 짤 순 없는지 조금만 더 고민해봐야겠습니다.
- util 함수에 대해 테스트를 작성했습니다. 컴포넌트 테스트는 안하더라도 최소한 util 함수에 대해서는 테스트를 하는 게 맞다고 생각을 해왔었는데 이제서야 실천에 옮겼습니다. 오랜만에 TDD로 날짜 관련 util 함수를 구현했는데 재미있었어요. 경험이 쌓이면서 코딩에 대한 기본적인 이해도가 올라서인지 1년전에 그렇게 어려웠고 이해도 안되던 mocking이 그렇게 높은 벽처럼 보이지 않아서 신기했습니다. 뭔가 지금도 잘은 모르지만 문서 보면서 필요한 곳에 사용할 순 있을 것 같아요.
- 이번주는 면접이 많았습니다. 저번주말부터 갑자기 면접이 쏙쏙 박히기 시작해가지구 바빴던 것 같아요. 그래서 하루에 코드를 치는 시간이 생각보다 부족해져서 피쳐를 치는데 예상했던 기간(넉넉하게 잡았는데도)이 아슬아슬 할 것 같습니다. 역시 예상 기간을 상정할때는 생각한 것의 1.5배를 부여하면 정말 잘 맞는 것 같아요...
- Suspense & ref 이슈를 또 마주쳤습니다. 개발하면서 Suspense를 사용하는 페이지를 만들때마다 항상 마주치는 것 같은데, 이번에는 왜 이러는지 궁금해서 서칭을 좀 해봤고 원인을 찾을 수 있었습니다. 별건 아니지만 해결방법도요! (추후 React 18로 올리면 된다...)

## Feelings

- 면접에 대한 고민이 많아지는 주간이었습니다. "내가 좋은 분을 놓치고 있는건 아닐까? 내깟게 뭐라고 너무 면접자에게만 높은 잣대를 들이미는건 아닐까?" 라는 생각이 많아졌습니다. 면접과정에서 면접자분의 더 좋은 장점들을 어떻게 하면 더 많이 끌어내볼 수 있을지 고민을 더 해봐야겠습니다. 지금은 너무 기술적인 부분에만 치중을 하고있는 듯한 느낌이 듭니다. (제가 기술적으로 뛰어나지 않은데도 ㅠ)

## Findings

- 컴포넌트 A, B가 트리 상에서 형제관계라고 가정해보겠습니다. React 17버전의 Suspense에서는 형제 컴포넌트 A가 프로미스를 던지는 중이고, 서스펜스가 이를 받아서 fallback을 렌더링하는 중에도 형제 컴포넌트 B는 마운트되는 이슈가 있습니다. 비록 B 컴포넌트가 렌더링은 하지 않더라도요.  
이러한 이슈 때문에 형제 컴포넌트 B에서 ReactElement에 ref를 부여하고 useEffect에서 ref 엘리먼트에 접근해서 `getBoundingClientRect` 같은 함수로 오프셋을 조사하게되면 렌더링은 되지 않았기 때문에 모두 0이 나오게 됩니다. 그래서 레이아웃이 깨지는 문제가 생기곤 했습니다.  
이런 현상은 버그라기보단 그냥 Legacy Suspense(React 18 미만의 버전들의 Suspense)의 동작 방식이었습니다. 그래서 추후 `ReactDOM.createRoot`를 사용하는 React 18 버전의 Concurrent Suspense에서는 형제 컴포넌트가 프로미스를 throw 하는 중에는 다른 형제컴포넌트가 마운트되지 않고 기다리는 방식으로 동작한다고 합니다.  
[(Behavioral changes to Suspense in React 18)](https://github.com/reactwg/react-18/discussions/7)
  
## Future Action Plans

- 지금도 막 자만하고 그런건 아니지만 그래도 더더더 겸손해질 수 있도록 해야겠습니다. 항상 겸손한 게 제일 중요한 것 같아요.

## Feedback
